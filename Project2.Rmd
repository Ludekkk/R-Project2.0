---
title: "Projekt2.0"
author: "Michał Baran"
date: "20 maja 2019"
output: html_document
---

```{r, message=FALSE, results='hide', echo=FALSE, warning=FALSE}
library(dplyr)
library(tidyr)
library(ggplot2)
library(tseries)
```

```{r}
#długość
n <- c(10,50,100,200)
#prawdopodobieństwo
p <- c(0.1,0.3,0.5,0.9)
#par_1
par1 <- c(2,1)
#par_2
par2 <- c(1,5)
#ilość symulacji
N <- 100
#alpha
alpha <- 0.1
#testy
testy <- c("SW","JB")
```


```{r}
data1 <- expand.grid(n,p,testy)
colnames(data1) <- c("Dlugosc", "Prawdopodobienstwo","Test")

```


```{r}
#ustawienie ziarna generatora na 20
set.seed(20)

powers <- sapply(1:nrow(data1),
                 function(i){
                   n <- data1[i, 1]
                   p <- data1[i, 2]
                   test <- data1[i, 3]
                   
                   p_vector <- sapply(rep(n, N), function(x){
                     sample <- rmix(n, "norm", par1, "norm", par2, p)
                     
                     if (test == "SW"){
                       result <- shapiro.test(sample)$p.value
                     } else if (test == "JB"){
                       result <- jarque.bera.test(sample)$p.value
                     }   
                     result
                   })
                   mean(p_vector < alpha)
                 })

data2 <- bind_cols(data1, Moc = powers)
```

